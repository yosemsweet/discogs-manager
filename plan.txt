# Discogs Manager CLI - Development Plan

## Project Overview
Command-line tool for managing Discogs collections and creating SoundCloud playlists. Full TypeScript/Node.js implementation with 5 commands, 125/125 tests passing.

**Build Status:** ✅ Clean | **Tests:** 125/125 (100%) | **Current Branch:** master

---

## Completed Work

### Prior Sessions (1-15)
Core CLI, Discogs API integration, SoundCloud OAuth 2.1, rate limiting, database, 5 commands (sync, list, stats, playlist, auth, retry), advanced filtering, retry/DLQ queues, progress feedback.

### Phase 1: Stability & Quality ✅ COMPLETE
**Effort:** ~7-8 hours total
- **Task 1:** Fixed 4 integration tests (91/95 → 125/125)
- **Task 2:** Refactored 6 commands with CommandBuilder utility (-180 boilerplate lines)
- **Task 3:** Created ErrorHandler with centralized error classification (13 error types)

---

## Future Work - Prioritized by Impact

### Phase 2: Services & Validation (WEEKS 3-4) - NEXT

**Priority 1: Enable TypeScript Strict Mode** ⭐
- Effort: 4-6h | Impact: HIGH
- Enable `strict: true` in tsconfig.json, fix `any` types across codebase

**Priority 2: Refactor PlaylistService** ⭐
- Effort: 6-8h | Impact: HIGH
- Extract TrackSearchService, PlaylistBatchManager; split concerns (currently ~300 lines)

**Priority 3: Add Input Validation Layer**
- Effort: 4-5h | Impact: MEDIUM
- Create Validator utility with schema validation; validate commands, API responses

### Phase 3: Performance (WEEKS 5-6)

**Priority 1: Implement Caching Layer**
- Effort: 5-7h | Impact: MEDIUM
- Cache release data, SoundCloud searches; time-based expiration (24h default)

**Priority 2: Database Access Refactoring**
- Effort: 3-4h | Impact: MEDIUM
- QueryBuilder for common queries, transactions, migrations, connection pooling

**Priority 3: Improve Concurrency**
- Effort: 4-6h | Impact: LOW-MEDIUM
- Parallel release fetching, batch size limits, queue system for rate-limited ops

### Phase 4: Robustness (WEEKS 7-8)

**Priority 1: Enhanced Logging**
- Effort: 2-3h | Impact: MEDIUM
- Structured logging (JSON), log levels, rotation, operation tracing

**Priority 2: Graceful Error Recovery**
- Effort: 3-4h | Impact: MEDIUM
- Retry with backoff, partial sync recovery, circuit breaker, timeout handling

**Priority 3: Data Sanitization & Security**
- Effort: 2-3h | Impact: LOW
- Input sanitization, rate limiting, OAuth security, secrets management

### Phase 5: Documentation (WEEKS 9-10)

**Priority 1: Comprehensive Documentation**
- Effort: 3-4h | Impact: MEDIUM
- ARCHITECTURE.md, API reference, troubleshooting, config documentation

**Priority 2: Improve Test Coverage**
- Effort: 4-5h | Impact: HIGH
- Edge case tests, performance benchmarks, integration tests, coverage reporting

**Priority 3: Setup CI/CD**
- Effort: 2-3h | Impact: MEDIUM
- GitHub Actions, pre-commit hooks, automated deployment, versioning

---

## Known Issues
- Playlist creation occasionally fails with 422 on certain genres
- Rate limit reset time may be off by seconds in edge cases

---

## Quick Reference

**Build/Test:**
```bash
npm run build   # TypeScript compilation
npm test       # All 125 tests
npm run dev -- sync  # Test command
```

**Docs:**
- `CODEBASE_REVIEW.md` - Detailed analysis
- `README.md` - User guide
- `API_REFERENCE.md` - API details

**Architecture:**
- `src/api/` - API clients (Discogs, SoundCloud)
- `src/services/` - Business logic
- `src/commands/` - CLI commands
- `src/utils/` - Utilities
- `tests/` - Test suite (125 tests)